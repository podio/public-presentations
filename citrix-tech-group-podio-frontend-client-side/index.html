
<!--
Google IO 2012 HTML5 Slide Template

Authors: Eric Bidelman <ebidel@gmail.com>
         Luke Mahé <lukem@google.com>

URL: https://code.google.com/p/io-2012-slides
-->
<!DOCTYPE html>
<html>
<head>
  <title>Podio: Going client-side on the web</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <!--<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">-->
  <!--<meta name="viewport" content="width=device-width, initial-scale=1.0">-->
  <!--This one seems to work all the time, but really small on ipad-->
  <!--<meta name="viewport" content="initial-scale=0.4">-->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="stylesheet" media="all" href="theme/css/default.css">
  <link rel="stylesheet" media="only screen and (max-device-width: 480px)" href="theme/css/phone.css">
  <base target="_blank"> <!-- This amazingness opens all links in a new tab. -->
  <script data-main="js/slides" src="js/require-1.0.8.min.js"></script>
</head>
<body style="opacity: 0">

<slides class="layout-widescreen">

  <slide class="title-slide segue nobackground">

    <img src="images/podio.png" class="podio-logo" />
    <hgroup class="auto-fadein">
      <h1 data-config-title></h1>
      <h2 data-config-subtitle></h2>
      <p data-config-presenter></p>
    </hgroup>
  </slide>

  <slide>
    <article class="flexbox vcenter">
      <p style="font-size: 50px; text-align: center;">Our team</p>
    </article>
  </slide>

  <slide>
    <article class="flexbox vcenter">
      <img src="images/team.png" alt="Description" title="Description">
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Our principles</h2>
    </hgroup>
    <article>
      <ul>
        <li>Constantly evolve product and platform</li>
        <li>Deliver & fail fast</li>
        <li>Data-driven (A/B testing, measure, feedback)</li>
        <li>The right tools for the job</li>
        <li>Focus on value creation for our customers</li>
      </ul>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Evolution of our platform (while airbourne)</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/evolution.jpg" alt="Description" title="Description">
    </article>
  </slide>

  <slide>
    <article class="flexbox vcenter">
      <p style="font-size: 50px; text-align: center;">First prototype (2009)</p>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Traditional website</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/fullstack.jpg" alt="Description" title="Description">
    </article>
  </slide>

  <slide>
    <article class="flexbox vcenter">
      <p style="font-size: 50px; text-align: center;">Podio API (2010)</p>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Central API</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/api.png" alt="Description" title="Description">
    </article>
  </slide>

  <slide>
    <article class="flexbox vcenter">
      <p style="font-size: 50px; text-align: center;">Project Zeus (2011)</p>
    </article>
  </slide>

  <slide>
    <article class="flexbox vcenter">
      <img src="images/zeus.png" alt="Description" title="Description">
    </article>
  </slide>

  <slide>
    <article class="flexbox vcenter">
      <p style="font-size: 50px; text-align: center;">Codename Hermes (2012)</p>
    </article>
  </slide>

  <slide class="segue dark nobackground">
    <hgroup>
      <h2>Going client side.</h2>
    </hgroup>
  </slide>

  <slide>
    <hgroup>
      <h2>Why going client side?</h2>
    </hgroup>

    <article class="flexbox vcenter">
      <p style="font-size: 50px; text-align: center;">Product ambition.</p>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Why going client side?</h2>
    </hgroup>

    <article class="flexbox vcenter">
      <p style="font-size: 50px; text-align: center;">User experience.</p>
    </article>
  </slide>

   <slide>
    <hgroup>
      <h2>Technology is here.</h2>
    </hgroup>

    <article class="flexbox vcenter">
      <img src="images/browsers.jpg" alt="Description" title="Description">
    </article>
  </slide>

   <slide>
    <hgroup>
      <h2>Client-side architecture distribution</h2>
    </hgroup>

    <article class="flexbox vcenter">
      <img src="images/clientside.jpg" alt="Description" title="Description">
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>New problem</h2>
    </hgroup>

    <article class="flexbox vcenter">
      <p style="font-size: 50px; text-align: center;">Manage state in a good way.</p>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Goals</h2>
    </hgroup>

    <article>
      <ul>
        <li>
          Faster and more responsive user experience
          <ul>
            <li>Better preceived performance</li>
          </ul>
          <br />
        </li>
        <li>
          Separation of concerns
          <ul>
            <li>Decouple from the DOM</li>
            <li>Reuse of components</li>
          </ul>
          <br />
        </li>
        <li>
          More reliability & less regression
          <ul>
            <li>Unit and integration tests</li>
            <li>Faster development</li>
          </ul>
          <br />
        </li>
      </ul>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Requirements</h2>
    </hgroup>

    <article>
      <ul>
        <li>
          Fit existing infrastructure. Hybrid.
          <ul>
            <li>Live on top of existing front-end</li>
            <li>Same stack</li>
            <li>Lightweight</li>
            <li>Long lived</li>
          </ul>
          <br />
        </li>
        <li>
          Simple to understand.
          <ul>
            <li>Similar to Rails</li>
            <li>Productivity</li>
            <li>Onboarding</li>
            <li>Cross-codebase</li>
          </ul>
          <br />
        </li>
      </ul>
    </article>
  </slide>

  <slide>
    <article class="flexbox vcenter">
      <img src="images/backbone.png" alt="Description" title="Description">
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Why Backbone?</h2>
    </hgroup>
    <article>
      <ul>
        <li>Many opinionated frameworks (JavaScript MVC, SproutCore, Knockout)</li>
        <li>Minimalistic and extensible (1500 lines)</li>
        <li>No lock-in into specific patterns/tools</li>
        <li>Fit our existing infrastructure</li>
      </ul>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Backbone introduction</h2>
    </hgroup>
    <article>
      <ul>
        <li>It's MV* - not MVC</li>
      </ul>
      <ul>
        <li>Models</li>
        <li>Collections</li>
        <li>Views</li>
        <li>Routers</li>
      </ul>
      <p>And also:</p>
      <ul>
        <li>Easy inheritance</li>
        <li>Events (Pub/Sub) mixed into objects</li>
      </ul>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Backbone: Models</h2>
    </hgroup>
    <article class="smaller">
      <ul>
        <li>Encapsulates data and domain logic</li>
        <li>Serializable to JSON</li>
        <li>RESTful data fetching, persistence and URL management built in</li>
        <li>Validation</li>
        <li>Fires events on changes</li>
      </ul>
      <pre class="prettyprint" data-lang="javascript">
        var model = Backbone.Model.extend({
          toggleLike: function() {
            if (this.get('liked')) {
              this.unlike();
            } else {
              this.like();
            }
          },

          like: function() {
            this.set({ liked: true });
          },

          unlike: function() {
            this.set({ liked: false });
          }
        });
      </pre>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Backbone: Collections</h2>
    </hgroup>
    <article class="smaller">
      <ul>
        <li>Collection of models and operations</li>
        <li>Full range of methods from underscore.js built in</li>
        <li>Fires events on add/remove</li>
      </ul>

    <pre class="prettyprint" data-lang="javascript">
  var collection = Backbone.Collection.extend({
  
    model: Podio.Models.Meeting,
    url: '/backbone',
  
    getAllByProperty: function(propertyValue) {
      return this.filter(function(model) {
        return model.get('property') === propertyValue;
      });
    }

  });
    </pre>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Backbone: Views</h2>
    </hgroup>
    <article class="smaller">
      <ul>
        <li>Renders data using templates</li>
        <li>Reacts on DOM events</li>
      </ul>
    <pre class="prettyprint" data-lang="javascript">
var ActionBarView = Backbone.View.extend({
  tagName:  "li",
  template: _.template($('#item-template').html()),
  events: {
    "click .toggle"   : "toggleDone",
    "dblclick .view"  : "edit",
  },

  initialize: function() {
    this.model.on('change', this.render, this);
    this.model.on('destroy', this.remove, this);
  },

  render: function() {
    this.$el.html(this.template(this.model.toJSON()));
    this.$el.toggleClass('done', this.model.get('done'));
    return this;
  },

  edit: function() {
    this.$el.addClass("editing");
    this.input.focus();
  }
}
</pre>

    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Backbone: Router</h2>
    </hgroup>
    <article>
      <ul>
        <li>Triggers state changes</li>
        <li>Hashbangs OR pushState</li>
      </ul>
    </article>

    <pre class="prettyprint" data-lang="javascript">
var router = Backbone.PodioRouter.extend({
  routes : {
    "items/:pageNum:"  : { action: "index" }
    },

   routesindex : function (pageNum) {

   }
});
    </pre>
  </slide>

  <slide>
    <hgroup>
      <h2>Backbone:</h2>
    </hgroup>

    <article class="flexbox vcenter">
      <p style="font-size: 50px; text-align: center;">
        <a href="http://jsfiddle.net/fredsmoo/PQy6h/" target="_blank">Demo time!</a>
      </p>
    </article>
  </slide>

  <slide class="segue dark nobackground">
    <hgroup>
      <h2>Our learnings.</h2>
    </hgroup>
  </slide>

  <slide>
    <hgroup>
      <h2>Backbone event flow</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/mvc_backbone.png" alt="Description" title="Description">
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Limitations of MV* Frameworks</h2>
    </hgroup>
    <article>
      <ul>
        <li>Tight binding between Views and Models does not scale</li>
        <li>Separate data updates from actions</li>
        <li>Sharing models across components is not a good idea</li>
        <li>Views are context specific</li>
        <li>We want to return multiple models at once</li>
      </ul>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Our extensions for Backbone</h2>
    </hgroup>
    <article>
      <ul>
        <li>Controllers & Event Bus</li>
        <li>Hybrid routing</li>
        <li>Model relations</li>
        <li>Rendering and view helpers</li>
        <li>Better class inherientance</li>
      </ul>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Podio event flow</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/mvc_podio.png" alt="Description" title="Description">
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>The controller</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/mvc_podio3.png" alt="Description" title="Description">
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>A single component</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/mvc_podio2.png" alt="Description" title="Description">
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Podio event flow</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/mvc_podio1.png" alt="Description" title="Description">
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Controllers</h2>
    </hgroup>
    <article>
      <ul>
        <li>Decoupling Views and Models</li>
        <li>Single point of responsibility (top-down actions only)</li>
        <li>Views are generic, Controllers are context-aware</li>
        <li>Controllers manage components and the global state</li>
        <li>Subcontrollers when necessary</li>
      </ul>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Controllers</h2>
    </hgroup>
    <article>
      <pre class="prettyprint" data-lang="javascript">
var calendarsController = Backbone.PodioController.extend({
  bindEvents: function() {
    this.eventBus.bind('componentOne:addService', this.onServiceAdded, this);
  },

  initialize: function () {
    this.eventBus = _.extend({}, Backbone.Events);
    this.bindEvents();

    this.componentOne = new ComponentOne({ eventBus: this.eventBus });
  },

  onServiceAdded: function() {
    this.componentOne.triggerSomeBehavior();
  }
});
      </pre>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Event Bus</h2>
    </hgroup>
    <article>
      <ul>
        <li>All components are attached to one bus and signal their specific events</li>
        <li>Only controllers listen on the bus and act depending on their context and current state</li>
      </ul>
      <pre class="prettyprint" data-lang="javascript">
var componentOne = Backbone.PodioView.extend({
  events: {
    'click .trigger': 'onTriggerClick'
  },

  onTriggerClick: function() {
    this.trigger('componentOne:addService');
  }
});
      </pre>
    </article>
  </slide>


   <slide>
    <hgroup>
      <h2>View simplifications</h2>
    </hgroup>
    <article class="smaller">
      <pre class="prettyprint" data-lang="javascript">

define('views/Podio.Views.ActionBar', function (require) {

  return Backbone.PodioView.extend({

    initialize: function(options) {
      this.appId = options.appId;
      this._super();
    },

    podioEvents: {
      'click .action-bar .like' : 'onActionLikeClicked'
    },

    shortcuts: {
      'l' : 'onShortcutLikePressed',
    },

    onActionLikeClicked: function(elmTarget, e) {
      this.trigger('actionBar:likeTriggered', this.appId );
    }
  });

})

</pre>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Templates and view helpers</h2>
    </hgroup>
    <article>
      <ul>
        <li>Same helpers as in Rails make transition easy and developers happy</li>
        <li>Underscore's templating system is used which is minimalistic and compatible with Rails ERB syntax</li>
      </ul>

      <pre class="prettyprint" data-lang="html">
      ...
      &lt;div class=&quot;footer&quot;&gt;
        &lt;%- button(t('Done #filefinder'), '', { 'color': 'green', 'tabindex' : '3' }) %&gt;
        &lt;%- button(t('Cancel #filefinder'), '', { 'color': 'silver', 'class':'align-right' }) %&gt;
      &lt;/div&gt;
      ...
    </pre>

    </article>
  </slide>

  <slide>
    <article class="flexbox vcenter">
      <p style="font-size: 50px; text-align: center; margin-bottom: 20px; ">Was Backbone.js the right choice?</p>
      <a href="https://hoist.podio.com/development/files" target="_blank">Demo: Workspace files</a>
     </article>
  </slide>

  <slide class="segue dark nobackground">
    <hgroup>
      <h2>Testing.</h2>
    </hgroup>
  </slide>

  <slide>
    <hgroup>
      <h2>Unit testing</h2>
    </hgroup>
    <article>
      <ul>
        <li>Jasmine as a test suite</li>
        <li>Sinon.js as a mocking framework</li>
        <li>Using Evergreen gem to run tests headlessly (capybara-webkit) and in the browser</li>
      </ul>

      <pre class="prettyprint" data-lang="javascript">
it("function is called once", function () {
  var func = sinon.mock(myObject);
  func.expects("myFunction").once().returnsArg(0);

  myObject.myFunction();

  func.verify();
});
      </pre>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Acceptance testing</h2>
    </hgroup>
    <article class="">
     <img style="text-align: center; display: inline-block" src="images/autodt.png" alt="Description" title="Description">
    </article>
  </slide>


  <slide>
    <hgroup>
      <h2>Auto-DT</h2>
    </hgroup>
    <article class="">
      <ul>
        <li>Automated browser testing</li>
        <li>Began with Selenium & Capybara</li>
        <li>Tests written in Ruby</li>
        <li>Went headless with PhantomJS</li>
      </ul>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Auto-DT: Example</h2>
    </hgroup>
    <article>
      <pre class="prettyprint" data-lang="ruby">
def test_add_more_than_10_users_to_employee_network
    login_as(:user => :leela, :org => :planet_express) do |current_user, org|
      visit("#{@org.url}employeenetwork/invite")

      # Invite twelve users
      with PodioPicker do |w|
        12.times do |count|
          invited_user_email = "user#{count}@#{org.domains.first}"
          w.add_token('#simple_invitation_box', invited_user_email)
        end
      end

      # Send invitations
      find('#invite_button').click

      # Invite completed
      assert_path('/employeenetwork')
    end
  end
      </pre>
    </article>
  </slide>

  <slide class="segue dark nobackground">
    <hgroup>
      <h2>Going forward.</h2>
    </hgroup>
  </slide>

  <slide>
    <article class="flexbox vcenter">
      <p style="font-size: 50px; text-align: center;">Real-time experience.</p>
    </article>
  </slide>

  <slide>
    <article class="flexbox vcenter">
      <p style="font-size: 50px; text-align: center;">More automation.</p>
    </article>
  </slide>

  <slide>
    <article class="flexbox vcenter">
      <img style="text-align: center; display: inline-block; height: 400px; padding-bottom: 20px;" src="images/finger.png" alt="Description" title="Description">
      <p style="font-size: 50px; text-align: center;">Future is now.</p>
    </article>
  </slide>

  <slide class="thank-you-slide segue nobackground">
    <article class="flexbox vleft">
      <h2>Thanks.</h2>
    </article>
    <p class="auto-fadein" data-config-contact>
      <!-- populated from slide_config.json -->
    </p>
  </slide>


</slides>

</body>
</html>
